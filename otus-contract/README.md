# Выпускной проект: OTUS Договор
### Цель:
Закрепить и систематизировать знания, полученные на курсе "Microservice Architecture". Приобрести практические навыки использования технологий, актуальных в сфере разработки и проектирования систем на базе микросервисной архитектуры. Применить изученные паттерны и подходы для достижения оптимального результата.

### Назначение:
Система дистанционного заключения договора с потенциальными студентами online-школы OTUS.

### Технологический стэк:
Kubernetes, NGINX, Prometheus, Grafana, Java, Spring Framework, Camunda, PostgreSQL, MongoDB.

### User Experience:
Клиент на сайте otus.ru или через звонок оператору оставляет заявку на обучение. Задача попадает в целевую CRM систему, которая в свою очередь передаёт задачу в "OTUS Договор". Система проверяет наличие свободных мест на курсе и его актуальность. В случае успеха, генерирует и отправляет клиенту уникальную ссылку на ввод первичной информации, в противном случае - отправляет уведомление клиенту на email и webhook CRM системе об произошедшей ошибки, завершает процесс. В случае успешного развития событий на предыдущем шаге, клиент переходит по ссылке и заполняет требуемые данные. Система принимает полученную информацию. Формирует драфт договора и передаёт на подписание клиенту. Бронируется место на курсе, деактивируется промокод, если такой был указан, принимается факт подписи. "OTUS Договор" отправляет уведомление клиенту на email и webhook CRM системе об успешном завершении процесса. 

## Сервисы и их назначения

### User Service
1) Авторизация пользователей

### Contract Service
1) Cбор и хранение клиентских данных
2) Генерация документов

### Course Service
1) Учёт доступных курсов online-школы, для заключения договора
2) Бронирование места на курсе

### Promo Service
1) Хранение информации о промо-активностях
2) Валидация промокодов

### Notification Service
1) Отправка email уведомлений участникам процесса
2) Отправка webhooks

## Сценарии взаимодействий
[OpenApi тут](https://github.com/helloips/otus-microservice-architecture/blob/master/otus-contract/swagger.yaml)

### Администратор
Ответственный сотрудник online-школы, должен иметь возможность создавать/просматривать/обновлять/удалять следующие сущности:
1) Курсы
2) Акции

А также получать данные в соответствии с заданными критериями по следующим сущностям:
1) Уведомления
![admin](https://user-images.githubusercontent.com/87579523/139543024-e30be218-376e-4ded-a2f6-ffc8a2ac0725.png)

### CRM
Целевая система-источник должна иметь возможность создавать/удалять следующие сущности:
1) Договор

А также иметь возможность получать уведомления о результате работы системы:
![crm](https://user-images.githubusercontent.com/87579523/139647871-60a877d7-d3bd-4107-a3bf-e6b711244b87.png)

### Клиент
Потенциальный студент должен иметь возможность дать согласие на использование персональных данных (в части "ЕСИА" и "Госуслуги"), требуемые для договора, а также получить скидку:
![client](https://user-images.githubusercontent.com/87579523/139669910-06ddb352-79dd-4aa0-bc52-c45b38dda987.png)

### Основной сценарий заключения договора
Оркестрация выше описанных сервисов выполняется средствами Camunda. Межсервисное взаимодействие и передача результатов работы осуществляется через обновление контекста параметров задачи. Сервисы работают по принципу External Task Client - забирая задачу на обработку в соответствии с движением по маршруту:
![diagram](https://user-images.githubusercontent.com/87579523/139316107-a734eb3e-e188-4ffe-80d2-067281d81935.png)

## Комментарии
Для скрепления договора используем "Госключ". Принимаем его за MOCK.
